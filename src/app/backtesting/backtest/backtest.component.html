<div class="backtest-container">
  <h2>Run Backtest</h2>

  <form [formGroup]="backtestForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="symbol">Symbol:</label>
      <input type="text" id="symbol" formControlName="symbol" class="form-control">
      <div *ngIf="backtestForm.get('symbol')?.invalid && backtestForm.get('symbol')?.touched" class="text-danger">
        Symbol is required.
      </div>
    </div>

    <div class="form-group">
      <label for="fromDate">From Date:</label>
      <input type="date" id="fromDate" formControlName="fromDate" class="form-control">
      <div *ngIf="backtestForm.get('fromDate')?.invalid && backtestForm.get('fromDate')?.touched" class="text-danger">
        From Date is required.
      </div>
    </div>

    <div class="form-group">
      <label for="toDate">To Date:</label>
      <input type="date" id="toDate" formControlName="toDate" class="form-control">
      <div *ngIf="backtestForm.get('toDate')?.invalid && backtestForm.get('toDate')?.touched" class="text-danger">
        To Date is required.
      </div>
    </div>

    <div class="form-group">
      <label for="interval">Interval:</label>
      <select id="interval" formControlName="interval" class="form-control">
        <option value="day">Day</option>
        <option value="3minute">3 Minute</option>
        <option value="5minute">5 Minute</option>
        <option value="10minute">10 Minute</option>
        <option value="15minute">15 Minute</option>
        <option value="30minute">30 Minute</option>
        <option value="60minute">60 Minute</option>
      </select>
    </div>

    <button type="submit" class="btn btn-primary" [disabled]="backtestForm.invalid || loading">
      <span *ngIf="loading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
      <span *ngIf="!loading">Run Backtest</span>
    </button>

    <div *ngIf="errorMessage" class="alert alert-danger mt-3">{{ errorMessage }}</div>
  </form>

  <div *ngIf="backtestResult" class="backtest-results mt-4">
    <h3>Backtest Results:</h3>
    <p><strong>Initial Capital:</strong> {{ backtestResult.initialCapital | currency }}</p>
    <p><strong>Final Capital:</strong> {{ backtestResult.finalCapital | currency }}</p>
    <p><strong>Total PnL:</strong> {{ backtestResult.totalProfitLoss | currency }}</p>
    <p><strong>Number of Trades:</strong> {{ backtestResult.numberOfTrades }}</p>
    <p><strong>Winning Trades:</strong> {{ backtestResult.winningTrades }}</p>
    <p><strong>Losing Trades:</strong> {{ backtestResult.losingTrades }}</p>
    <p><strong>Win Rate:</strong> {{ backtestResult.winRate | number:'1.2-2' }}%</p>
  </div>
</div>
